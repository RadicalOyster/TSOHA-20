{% extends "layout.html" %}

{% block body %}
<div style="background-color: #ebe1c7" style="width: 1500px">
    <h2 style="color:maroon">{{creature.name}}</h2>
    <b>Armor Class:</b> {{ creature.ac }}
    <br />
    <b>HP: </b> {{ creature.hp }} ({{ creature.formula }})
    <br />
    <b>Challenge: </b>{{ creature.cr }}
    <br />
    <br />
    <table style="width:300px">
        <tr style="color:maroon">
            <th>STR</th>
            <th>DEX</th>
            <th>CON</th>
            <th>INT</th>
            <th>WIS</th>
            <th>CHA</tH>
        </tr>

        <tr>
            <td align="center"> {{ creature.str }}</td>
            <td align="center"> {{ creature.dex }}</td>
            <td align="center"> {{ creature.con }}</td>
            <td align="center"> {{ creature.int }}</td>
            <td align="center"> {{ creature.wis }}</td>
            <td align="center"> {{ creature.cha }}</td>
        </tr>

        <tr style="color:maroon">
            <th>Speed</th>
            <th>Fly</th>
            <th>Swim</th>
        </tr>

        <tr>
            <td align="center"> {{ creature.speed }} ft.</td>
            <td align="center"> {{ creature.flyspeed }} ft.</td>
            <td align="center"> {{ creature.swimspeed }} ft.</td>
        </tr>
    </table>
    <br/>
    <div style=color:maroon><b>Skills</b></div>
    <table>
        <br/>
        <tr>
            <h2 style="color:maroon">Abilities</h2>
        </tr>
        {% for ability in creature.abilities %}
        <div style="background-color: #ebe1c7" style="width: 1500px">
            <b>{{ability.name}}.</b> <i>{{ability.description}}</i>
            {% if ability.attack %}
            : {{ability.attack.toHit}} to hit.
            <i>On hit: </i> {{ability.attack.damageFormula}} {{ability.attack.damageType[0].type}} damage.
            {% endif %}
        </div>
        {% endfor %}
    </table>
    {% if "ADMIN" in (current_user.roles|map(attribute='name')) %}
    <h3>Edit stats</h3>
    <form method="POST" action="{{ url_for('change_creature_stats', creature_id=creature.id) }}">
        <table>
            <tr>
                <td>
                    {{ form.name.label }}
                </td>
                <td>
                    {{ form.name }}
                </td>
                <td>
                    {{ form.hp.label }}
                </td>
                <td>
                    {{ form.hp }}
                </td>
                <td>
                    {{ form.formula.label }}
                </td>
                <td>
                    {{ form.formula }}
                </td>
                <td>
                    {{ form.ac.label }}
                </td>
                <td>
                    {{ form.ac }}
                </td>
            </tr>
            <tr>
                <td>
                    {{ form.speed.label }}
                </td>
                <td>
                    {{ form.speed }}
                </td>
                <td>
                    {{ form.flyspeed.label }}
                </td>
                <td>
                    {{ form.flyspeed }}
                </td>
                <td>
                    {{ form.swimspeed.label }}
                </td>
                <td>
                    {{ form.swimspeed }}
                </td>
            </tr>
            <tr>
                <td>
                    {{ form.strength.label }}
                </td>
                <td>
                    {{ form.strength }}
                </td>
                <td>
                    {{ form.dex.label }}
                </td>
                <td>
                    {{ form.dex }}
                </td>
                <td>
                    {{ form.con.label }}
                </td>
                <td>
                    {{ form.con }}
                </td>
            </tr>
            <tr>
                <td>
                    {{ form.intelligence.label }}
                </td>
                <td>
                    {{ form.intelligence }}
                </td>
                <td>
                    {{ form.wis.label }}
                </td>
                <td>
                    {{ form.wis }}
                </td>
                <td>
                    {{ form.cha.label }}
                </td>
                <td>
                    {{ form.cha }}
                </td>
            </tr>
            <tr>
                <td>
                    {{ form.cr.label }}
                </td>
                <td>
                    {{ form.cr }}
                </td>
            </tr>
            <tr>
            </tr>
            <tr>
                <td colspan="2">
                    <input type="submit" value="Update stats" />
                </td>
            </tr>
        </table>
    </form>
    <form method="POST" action="{{ url_for('delete_creature', creature_id=creature.id) }}">
        <input type=hidden value="{{ creature.id }}" name=creature_to_delete>
        <input type="submit" value="Delete Creature"/>
    </form>
</div>
<div>
    <ul>
        {% for field in form.errors %}
        {% for error in form.errors[field] %}
        <div class="alert alert-error">
            <strong style="color:red">Error in field {{field}}</strong> {{error}}
        </div>
        {% endfor %}
        {% endfor %}
    </ul>
</div>
{% endif %}
{% endblock %}